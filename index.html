<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>9 Promises</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,400&family=Space+Grotesk:wght@300;400;500&display=swap" rel="stylesheet">
    
    <style>
        /* --- CORE RESET --- */
        body {
            font-family: 'Space Grotesk', sans-serif;
            background-color: #000000;
            color: #e2e8f0;
            overflow: hidden;
            touch-action: none;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            -webkit-user-select: none;
        }
        
        .serif { font-family: 'Cormorant Garamond', serif; }

        /* --- LAYERING --- */
        #layer-bg { position: absolute; inset: 0; z-index: 0; pointer-events: none; }
        #layer-ui { position: relative; z-index: 50; width: 100%; height: 100%; }

        /* --- BACKGROUND BOKEH --- */
        .orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.4;
            mix-blend-mode: screen;
            animation: float 25s infinite ease-in-out alternate;
        }
        #orb1 { background: #312e81; width: 80vw; height: 80vw; top: -10%; left: -10%; } /* Indigo */
        #orb2 { background: #064e3b; width: 90vw; height: 90vw; bottom: -10%; right: -10%; animation-direction: reverse; } /* Emerald */
        #orb3 { background: #4c1d95; width: 60vw; height: 60vw; top: 40%; left: 20%; } /* Violet */

        @keyframes float { 
            0% { transform: translate(0,0); } 
            100% { transform: translate(30px, -30px); } 
        }

        /* --- UI COMPONENTS --- */
        .glass-box {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        .gold-text {
            background: linear-gradient(to bottom, #fff, #fde047);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            color: #fde047; /* Fallback */
        }

        /* --- ANIMATION ENGINE (CSS KEYFRAMES) --- */
        
        /* 1. Word Reveal (Blur Fade) */
        .word-wrapper {
            display: inline-block;
            white-space: pre;
            margin-right: 0.25em;
        }
        
        .animate-word {
            opacity: 0; /* START INVISIBLE */
            display: inline-block;
            transform: translateY(10px) scale(0.95);
            filter: blur(10px);
            animation: textReveal 1s forwards cubic-bezier(0.2, 1, 0.3, 1);
        }

        @keyframes textReveal {
            0% { opacity: 0; transform: translateY(10px) scale(0.95); filter: blur(10px); }
            100% { opacity: 1; transform: translateY(0) scale(1); filter: blur(0); }
        }

        /* 2. Line Reveal */
        .animate-line {
            opacity: 0;
            transform: translateY(10px);
            filter: blur(5px);
            animation: lineReveal 1.2s forwards ease-out;
        }

        @keyframes lineReveal {
            to { opacity: 1; transform: translateY(0); filter: blur(0); }
        }

        /* 3. Page Transitions */
        .fade-enter { animation: fadeIn 1.5s ease forwards; }
        .fade-exit { animation: fadeOut 0.5s ease forwards; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }

    </style>
</head>
<body class="h-dvh w-full overflow-hidden bg-black">

    <audio id="bg-music" loop preload="auto">
        <source src="https://cdn.pixabay.com/download/audio/2022/08/02/audio_884fe92c21.mp3?filename=cosmic-glow-6703.mp3" type="audio/mpeg">
        <source src="https://cdn.pixabay.com/download/audio/2023/02/28/audio_5505e09c85.mp3" type="audio/mpeg">
    </audio>

    <div id="layer-bg">
        <div id="orb1" class="orb"></div>
        <div id="orb2" class="orb"></div>
        <div id="orb3" class="orb"></div>
        <div class="absolute inset-0 bg-black/40"></div>
    </div>

    <main id="app-container" class="fade-enter w-full h-full flex flex-col items-center justify-center p-4 text-center z-50 relative">
        </main>

    <script>
        // --- DATA ---
        const promises = [
            {
                visual: "Imagine yourself as a great, ancient tree standing alone in a vast field. A storm comes—wind screams, rain lashes—but your roots go so deep into the earth that you do not sway. You are not holding onto the ground; you are part of it.",
                mantra: "I am grounded. I am my own constant."
            },
            {
                visual: "Visualize a mirror in front of you. See your reflection, but strip away the makeup, the filters, and the exhaustion. Look into your own eyes until you see the little girl hiding behind them. Smile at her. She has been waiting for you to see her.",
                mantra: "I do not need them to see me. I see myself."
            },
            {
                visual: "Imagine your heart is a small, fragile bird resting in your hands. It has been bruised by harsh words—some from others, but most from you. Gently stroke its feathers. Apologize to it. Promise to protect it from your own cruelty.",
                mantra: "I will speak to myself with kindness."
            },
            {
                visual: "Picture a heavy iron door in your chest that you’ve kept locked to keep pain out. But it has also kept the sun out. Visualize yourself slowly turning the key. It’s scary, but you push it open. Warm, golden light floods in.",
                mantra: "I am open to the joy that is seeking me."
            },
            {
                visual: "Summon the version of you from your lowest moment. The one who was crying on the floor, feeling entirely alone. Walk up to her. Sit beside her. Wrap your arms around her and whisper, 'I'm here now. We made it.'",
                mantra: "I forgive you. You did the best you could."
            },
            {
                visual: "Imagine a circle drawn in gold dust around your feet. Inside this circle, the air is clean and quiet. Outside is the noise of the world. You realize you are the gatekeeper. Nothing enters this circle without your permission.",
                mantra: "My peace is sacred. I protect it."
            },
            {
                visual: "Imagine you are standing in a library filled with all the books of your life. There is a quiet whisper that has always guided you to the right page, even when you were lost. It is not loud, but it is true. Listen to it now.",
                mantra: "I trust the wisdom within my soul."
            },
            {
                visual: "Look at your hands. Look at your legs. They have carried you through every heartbreak, every illness, every long night. They never gave up on you. Imagine kissing your own hands in gratitude.",
                mantra: "I honor this vessel. I am alive."
            },
            {
                visual: "Imagine standing at an altar. There is no groom or bride waiting for you. There is just you, waiting for you. You take your own hands. You look into your own eyes. You say, 'I do.'",
                mantra: "I am the love of my own life."
            }
        ];

        // --- STATE ---
        let state = {
            index: 0,
            holding: false,
            progress: 0,
            animFrame: null
        };

        const dom = {
            container: document.getElementById('app-container'),
            audio: document.getElementById('bg-music')
        };

        // --- CORE FUNCTIONS ---

        // 1. Audio Manager (Click Trigger)
        function playAudio() {
            dom.audio.muted = false;
            dom.audio.volume = 0.5;
            const p = dom.audio.play();
            if (p !== undefined) {
                p.catch(e => console.log("Audio waiting for interaction..."));
            }
        }

        // 2. Text Animator (The Blur Fade Engine)
        function injectAnimatedText(element, text) {
            const words = text.split(" ");
            let html = "";
            words.forEach((word, i) => {
                // Stagger: 0.25s per word
                const delay = i * 0.25; 
                html += `<span class="word-wrapper"><span class="animate-word" style="animation-delay: ${delay}s">${word}</span></span>`;
            });
            element.innerHTML = html;
            return (words.length * 0.25) + 0.8; // Return total seconds
        }

        // 3. Haptics
        function vibrate(p) { if(navigator.vibrate) navigator.vibrate(p); }

        // --- SCENES ---

        function renderInstructions() {
            dom.container.innerHTML = `
                <div class="glass-box p-8 rounded-2xl w-full max-w-sm mb-12 text-left relative overflow-hidden">
                    <div class="absolute top-0 left-0 w-1 h-full bg-white/40"></div>
                    <h2 class="serif text-2xl text-white mb-4 tracking-wide">Preparation</h2>
                    <p class="text-sm text-slate-200 leading-7 mb-4 font-light">
                        This experience is best enabled through headphones. Ensure you are in a comfortable environment, away from distractions.
                    </p>
                    <p class="text-sm text-slate-200 leading-7 font-light">
                        Each screen contains visualizations to imagine with your eyes closed, while focusing on long, deep breaths (3 deep breaths are recommended).
                    </p>
                </div>
                
                <button id="btn-start" class="relative px-12 py-4 border border-white/20 rounded-full active:scale-95 transition-all bg-black/20 hover:bg-white/10 group">
                    <span class="text-xs tracking-[0.3em] uppercase text-white font-semibold group-hover:text-white/80">I Am Ready</span>
                </button>
            `;

            document.getElementById('btn-start').addEventListener('click', () => {
                vibrate(50);
                playAudio(); // Trigger Audio
                transitionTo(renderTitle);
            });
        }

        function renderTitle() {
            dom.container.innerHTML = `
                <div class="min-h-[120px] flex items-end justify-center w-full">
                    <h1 id="title-text" class="serif text-5xl md:text-6xl text-white tracking-widest leading-tight text-center"></h1>
                </div>
                <div class="h-px w-0 bg-white/50 mb-12 animate-[widthGrow_2s_ease_forwards_1s]"></div>
                
                <button id="btn-enter" class="opacity-0 transition-opacity duration-1000 text-xs uppercase tracking-[0.4em] text-white/50 hover:text-white p-4">
                    Enter
                </button>
                <style>@keyframes widthGrow { to { width: 100px; } }</style>
            `;

            injectAnimatedText(document.getElementById('title-text'), "9 PROMISES");

            setTimeout(() => {
                const btn = document.getElementById('btn-enter');
                btn.classList.remove('opacity-0');
                btn.onclick = () => {
                    vibrate(20);
                    transitionTo(renderVisual);
                };
            }, 2500);
        }

        function renderVisual() {
            const data = promises[state.index];

            dom.container.innerHTML = `
                <div class="text-[10px] tracking-[0.3em] uppercase text-white/40 mb-4">
                    Promise ${state.index + 1}
                </div>

                <div class="glass-box p-8 rounded-2xl w-full flex flex-col justify-center relative mb-8 min-h-[300px] max-h-[60vh] overflow-y-auto">
                    <div class="absolute -top-3 left-6 bg-black px-3 text-[10px] text-white/60 uppercase tracking-widest border border-white/10 rounded-full z-10">Visualize</div>
                    <div id="text-visual" class="serif text-xl text-slate-100 leading-9 font-light tracking-wide text-left">
                        </div>
                </div>

                <div id="action-ui" class="flex flex-col items-center justify-center opacity-0 transition-opacity duration-1000">
                    <p class="text-[10px] text-white/50 leading-relaxed text-center max-w-[280px] mb-6 font-light">
                        Close your eyes. Visualize. Breathe. <br>When ready, open eyes and hold below.
                    </p>
                    
                    <div id="btn-hold" class="relative w-24 h-24 flex items-center justify-center cursor-pointer active:scale-95 transition-transform touch-none select-none">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-white/30" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="0.5" d="M12 11c0 3.517-1.009 6.799-2.753 9.571m-3.44-2.04l.054-.09A13.916 13.916 0 008 11a4 4 0 118 0c0 1.017-.07 2.019-.203 3m-2.118 6.844A21.88 21.88 0 0015.171 17m3.839 1.132c.645-2.266.99-4.659.99-7.132A8 8 0 008 4.07M3 15.364c.64-1.319 1-2.8 1-4.364 0-1.457.2-2.858.571-4.182m1.51 4.182c.55 1.745 1.56 3.328 2.836 4.636M15 11h.01" />
                        </svg>
                        <svg class="absolute w-24 h-24 rotate-[-90deg]">
                            <circle class="text-white/10" stroke-width="1" stroke="currentColor" fill="transparent" r="46" cx="48" cy="48"/>
                            <circle id="progress-circle" class="text-white transition-all duration-75" stroke-width="2" stroke-dasharray="289" stroke-dashoffset="289" stroke-linecap="round" stroke="currentColor" fill="transparent" r="46" cx="48" cy="48"/>
                        </svg>
                    </div>
                </div>
            `;

            // Split by sentence for the visual part (block fades)
            const sentences = data.visual.match(/[^\.!\?]+[\.!\?]+/g) || [data.visual];
            const textContainer = document.getElementById('text-visual');
            textContainer.innerHTML = sentences.map((s, i) => 
                `<div class="animate-line mb-4 last:mb-0" style="animation-delay: ${i*0.8}s">${s.trim()}</div>`
            ).join('');

            const totalDelay = sentences.length * 800 + 500;
            setTimeout(() => {
                document.getElementById('action-ui').classList.remove('opacity-0');
                bindHoldEvents();
            }, totalDelay);
        }

        function renderMantra() {
            const data = promises[state.index];

            dom.container.innerHTML = `
                <div class="w-full h-full flex flex-col items-center justify-center px-4">
                    <div class="min-h-[200px] flex items-center justify-center">
                        <h2 id="text-quote" class="serif text-3xl md:text-4xl gold-text text-center leading-normal tracking-wide drop-shadow-lg"></h2>
                    </div>
                    
                    <button id="btn-next" class="mt-16 opacity-0 px-8 py-3 border-b border-white/20 text-xs uppercase tracking-[0.3em] text-white/50 hover:text-white hover:border-white transition-all">
                        Proceed
                    </button>
                </div>
            `;

            // Use the Blur-Fade Injector here
            const durationSec = injectAnimatedText(document.getElementById('text-quote'), `"${data.mantra}"`);
            
            setTimeout(() => {
                const btn = document.getElementById('btn-next');
                btn.classList.remove('opacity-0');
                btn.onclick = () => {
                    vibrate(20);
                    state.index++;
                    if(state.index < promises.length) {
                        transitionTo(renderVisual);
                    } else {
                        transitionTo(renderFinale);
                    }
                };
            }, durationSec * 1000 + 500);
        }

        function renderFinale() {
            dom.container.innerHTML = `
                <div class="w-32 h-32 rounded-full bg-white/10 blur-[80px] animate-pulse mb-8 absolute"></div>
                
                <div class="min-h-[80px] flex items-center justify-center mb-6 z-10">
                    <h1 id="text-final-title" class="serif text-4xl text-white"></h1>
                </div>
                
                <div class="glass-box p-8 rounded-xl w-full text-center z-10 max-w-sm">
                    <div id="text-final-body" class="serif text-xl text-slate-200 leading-relaxed font-light mb-6 min-h-[100px] flex items-center justify-center"></div>
                    <div class="h-px w-10 bg-white/20 mx-auto mb-6"></div>
                    <p class="text-[10px] text-white/40 uppercase tracking-widest">
                        Promise Day 2026
                    </p>
                </div>
            `;

            injectAnimatedText(document.getElementById('text-final-title'), "Welcome Home.");

            setTimeout(() => {
                const el = document.getElementById('text-final-body');
                el.innerHTML = `<div class="animate-line">You have spent your whole life looking for a place to rest. You didn't realize that you are the home you were looking for.</div>`;
            }, 2000);
            
            vibrate([50, 100, 50, 100]);
        }

        // --- INTERACTION LOGIC ---

        function bindHoldEvents() {
            const btn = document.getElementById('btn-hold');
            const circle = document.getElementById('progress-circle');
            const total = 289;

            const start = (e) => {
                if(e.cancelable) e.preventDefault();
                state.holding = true;
                vibrate(20);
                loop();
            };

            const end = () => {
                state.holding = false;
                state.progress = 0;
                circle.style.strokeDashoffset = total;
                cancelAnimationFrame(state.animFrame);
            };

            const loop = () => {
                if (!state.holding) return;
                state.progress += 1.5;
                
                const offset = total - (state.progress / 100) * total;
                circle.style.strokeDashoffset = offset;

                if (Math.floor(state.progress) % 20 === 0) vibrate(5);

                if (state.progress >= 100) {
                    state.holding = false;
                    vibrate([50, 50, 100]);
                    transitionTo(renderMantra);
                } else {
                    state.animFrame = requestAnimationFrame(loop);
                }
            };

            btn.addEventListener('mousedown', start);
            btn.addEventListener('touchstart', start, {passive: false});
            btn.addEventListener('mouseup', end);
            btn.addEventListener('touchend', end);
            btn.addEventListener('mouseleave', end);
        }

        function transitionTo(renderFn) {
            dom.container.classList.add('fade-out');
            setTimeout(() => {
                dom.container.innerHTML = '';
                dom.container.classList.remove('fade-out');
                renderFn();
            }, 500);
        }

        // --- INIT ---
        window.onload = renderInstructions;

    </script>
</body>
</html>
