<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>The Inner Promise</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,400&family=Space+Grotesk:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        /* --- Core Aesthetic --- */
        body {
            font-family: 'Space Grotesk', sans-serif;
            background-color: #020202; /* Deepest black */
            color: #e2e8f0;
            overflow: hidden;
            touch-action: none;
            overscroll-behavior: none;
            -webkit-tap-highlight-color: transparent;
            transition: background-color 2s ease;
        }
        
        .serif { font-family: 'Cormorant Garamond', serif; }
        
        /* --- Dynamic Bokeh Background --- */
        .bokeh-container {
            position: absolute;
            inset: 0;
            z-index: 0;
            overflow: hidden;
            pointer-events: none;
        }
        .bokeh-orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.3; /* Increased opacity for distinct color */
            transition: background-color 3s ease, transform 10s ease-in-out;
            animation: float-orb 20s infinite alternate cubic-bezier(0.4, 0, 0.2, 1);
        }
        @keyframes float-orb {
            0% { transform: translate(0, 0) scale(1); }
            100% { transform: translate(40px, -40px) scale(1.15); }
        }

        /* --- Text Reveal Animation --- */
        .word-reveal {
            opacity: 0;
            filter: blur(12px);
            transform: translateY(15px);
            display: inline-block;
            margin-right: 0.25em;
            transition: all 1.5s cubic-bezier(0.2, 1, 0.3, 1);
        }
        .word-reveal.visible {
            opacity: 1;
            filter: blur(0);
            transform: translateY(0);
        }

        /* --- Animations --- */
        .fade-enter { animation: fadeIn 2s ease forwards; }
        .fade-exit { animation: fadeOut 1s ease forwards; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }

        @keyframes breathe-text {
            0%, 100% { opacity: 0.4; transform: scale(0.98); }
            50% { opacity: 1; transform: scale(1.02); }
        }

        /* --- UI Components --- */
        .glass-panel {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .progress-ring__circle {
            transition: stroke-dashoffset 0.1s linear;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }

        /* Vignette for cinematic focus */
        .vignette {
            position: absolute;
            inset: 0;
            pointer-events: none;
            background: radial-gradient(circle, transparent 30%, #020202 120%);
            opacity: 0.7;
            z-index: 5;
        }
    </style>
</head>
<body class="h-dvh w-full flex flex-col items-center justify-center relative">

    <audio id="bg-music" loop preload="auto">
        <source src="https://cdn.pixabay.com/download/audio/2022/11/22/audio_febc508520.mp3?filename=ethereal-meditation-126284.mp3" type="audio/mpeg">
    </audio>

    <div class="bokeh-container" id="bg-layer">
        <div id="orb-1" class="bokeh-orb w-[90vw] h-[90vw] top-[-20%] left-[-20%] bg-white/5"></div>
        <div id="orb-2" class="bokeh-orb w-[100vw] h-[100vw] bottom-[-30%] right-[-20%] bg-white/5"></div>
    </div>

    <div class="vignette"></div>

    <main id="app-container" class="relative z-10 w-full max-w-md h-full flex flex-col items-center justify-center p-8 text-center">
        </main>

    <script>
        // --- The Emotional Journey Data ---
        const promises = [
            { 
                instruction: "Close your eyes. Imagine your feet sinking into warm, soft earth. You are a tree that no storm can uproot.",
                mantra: "I am grounded. I am my own constant.",
                color: "#9f1239" // Deep Rose
            },
            { 
                instruction: "Visualize your younger self sitting in front of you. Kiss her forehead gently. Tell her she is safe now.",
                mantra: "I do not need them to see me. I see myself.",
                color: "#b45309" // Amber/Gold
            },
            { 
                instruction: "Place a hand over your heart. Feel its rhythm. It beats only for you, every single second.",
                mantra: "I choose to be kind to my heart.",
                color: "#be185d" // Pink
            },
            { 
                instruction: "Imagine a door opening to a room filled with light. You are allowed to walk in. You belong there.",
                mantra: "I am open to the joy that is seeking me.",
                color: "#047857" // Emerald
            },
            { 
                instruction: "Think of a mistake you made. Now imagine hugging the version of you who made it. She didn't know better.",
                mantra: "I forgive you. You did the best you could.",
                color: "#1d4ed8" // Deep Blue
            },
            { 
                instruction: "Imagine a golden circle drawn around you. Inside this circle, only peace is allowed.",
                mantra: "My peace is sacred. I protect it with love.",
                color: "#4338ca" // Indigo
            },
            { 
                instruction: "Focus on the space between your eyebrows. Clear the noise. Listen to the silence.",
                mantra: "I trust the wisdom within my soul.",
                color: "#7e22ce" // Purple
            },
            { 
                instruction: "Take a deep breath into your belly. Your body is the vessel of your life. Honor it.",
                mantra: "I honor my body. I am a vessel of life.",
                color: "#0f766e" // Teal
            },
            { 
                instruction: "Wrap your arms around yourself. Squeeze tight. Feel your own warmth.",
                mantra: "I promise to love myself, always and in all ways.",
                color: "#e11d48" // Bright Red
            }
        ];

        // --- State ---
        let currentIndex = 0;
        let isHolding = false;
        let progress = 0;
        let animationFrame;
        const audio = document.getElementById('bg-music');
        const container = document.getElementById('app-container');

        // --- Background Color Engine ---
        function updateBackground(hexColor) {
            document.getElementById('orb-1').style.backgroundColor = hexColor;
            document.getElementById('orb-2').style.backgroundColor = hexColor;
        }

        // --- Haptics ---
        function vibrate(pattern) {
            if(navigator.vibrate) navigator.vibrate(pattern);
        }

        // --- Audio Logic (Stealth Start) ---
        function initAudio() {
            audio.volume = 0;
            // Play returns a promise. We handle it silently.
            const playPromise = audio.play();
            
            if (playPromise !== undefined) {
                playPromise.then(_ => {
                    // Fade in smoothly over 3 seconds
                    let vol = 0;
                    const fade = setInterval(() => {
                        if (vol < 0.6) {
                            vol += 0.05;
                            audio.volume = vol;
                        } else {
                            clearInterval(fade);
                        }
                    }, 250);
                }).catch(error => {
                    console.log("Autoplay prevented. User interaction required.");
                });
            }
        }

        // --- Render: Intro ---
        function renderIntro() {
            container.innerHTML = `
                <div class="fade-enter flex flex-col items-center justify-center h-full">
                    <div class="w-1 h-16 bg-gradient-to-b from-transparent via-white/50 to-transparent mb-8"></div>
                    <h1 class="serif text-5xl mb-6 gold-text tracking-widest text-white/90">Sanctuary</h1>
                    <p class="text-slate-400 text-sm mb-12 font-light tracking-wide opacity-80 leading-6">
                        A quiet place to come home to yourself.<br>
                        <span class="text-xs opacity-50 uppercase tracking-widest mt-2 block">Audio Enabled</span>
                    </p>
                    
                    <button id="start-btn" class="group relative px-8 py-3 rounded-full border border-white/20 transition-all active:scale-95 hover:bg-white/5">
                        <span class="text-xs uppercase tracking-[0.25em] text-white/90 group-hover:text-white">Enter Sanctuary</span>
                    </button>
                </div>
            `;
            
            document.getElementById('start-btn').addEventListener('click', () => {
                // Secretly start audio here
                initAudio();
                vibrate(50);
                transitionTo(renderInstruction);
            });
        }

        // --- Render: Step 1 (Instruction + Breathing) ---
        function renderInstruction() {
            const current = promises[currentIndex];
            updateBackground(current.color);

            container.innerHTML = `
                <div class="fade-enter flex flex-col items-center justify-center h-full w-full relative px-4">
                    <div class="absolute top-0 text-[9px] text-white/20 tracking-[0.3em] uppercase">
                        Promise ${currentIndex + 1}
                    </div>

                    <div class="max-w-xs text-center mb-10">
                        <p class="text-[10px] text-white/40 uppercase tracking-widest mb-6 font-bold">Visualize</p>
                        <p class="serif text-xl md:text-2xl text-slate-100 leading-relaxed font-light opacity-90">
                            "${current.instruction}"
                        </p>
                    </div>

                    <div class="mb-12 flex flex-col items-center animate-[breathe-text_4s_infinite_ease-in-out]">
                        <p class="text-xs text-white/50 tracking-[0.2em] uppercase mb-2">Breathe In...</p>
                        <div class="w-1 h-1 bg-white rounded-full mb-2"></div>
                        <p class="text-xs text-white/50 tracking-[0.2em] uppercase">Breathe Out (3x)</p>
                    </div>

                    <div id="hold-area" class="flex flex-col items-center justify-center">
                        <div id="hold-trigger" class="relative w-20 h-20 flex items-center justify-center cursor-pointer touch-none select-none active:scale-95 transition-transform duration-300">
                            <div class="w-12 h-12 rounded-full border border-white/20 flex items-center justify-center">
                                <div class="w-1 h-1 bg-white/50 rounded-full"></div>
                            </div>
                            
                            <svg class="progress-ring absolute w-20 h-20 top-0 left-0" width="80" height="80">
                                <circle id="progress-circle" class="progress-ring__circle" stroke="white" stroke-width="1" fill="transparent" r="38" cx="40" cy="40" stroke-dasharray="239" stroke-dashoffset="239" stroke-linecap="round" />
                            </svg>
                        </div>
                        <p class="mt-4 text-[9px] text-white/30 uppercase tracking-widest">Hold to Internalize</p>
                    </div>
                </div>
            `;

            setupHoldLogic();
        }

        // --- Interaction Logic ---
        function setupHoldLogic() {
            const trigger = document.getElementById('hold-trigger');
            const circle = document.getElementById('progress-circle');
            const circumference = 2 * Math.PI * 38;

            const start = (e) => {
                if(e.cancelable) e.preventDefault();
                isHolding = true;
                vibrate(20);
                loop();
            };

            const end = (e) => {
                if(e) e.preventDefault();
                isHolding = false;
                progress = 0;
                circle.style.strokeDashoffset = circumference;
                if(animationFrame) cancelAnimationFrame(animationFrame);
            };

            const loop = () => {
                if(!isHolding) return;
                progress += 0.8; // Slower, more deliberate hold
                const offset = circumference - (progress / 100) * circumference;
                circle.style.strokeDashoffset = offset;

                // Subtle haptic tick
                if(Math.floor(progress) % 25 === 0) vibrate(5);

                if(progress >= 100) {
                    isHolding = false;
                    vibrate([50, 50, 100]);
                    transitionTo(renderReveal);
                } else {
                    animationFrame = requestAnimationFrame(loop);
                }
            }

            trigger.addEventListener('touchstart', start, {passive: false});
            trigger.addEventListener('touchend', end);
            trigger.addEventListener('mousedown', start);
            trigger.addEventListener('mouseup', end);
            trigger.addEventListener('mouseleave', end);
        }

        // --- Render: Step 2 (The Reveal) ---
        function renderReveal() {
            const current = promises[currentIndex];
            
            container.innerHTML = `
                <div class="fade-enter flex flex-col items-center justify-center h-full w-full px-6">
                    <div class="min-h-[200px] flex items-center justify-center">
                        <h2 id="mantra-text" class="serif text-3xl md:text-4xl text-white text-center leading-snug tracking-wide"></h2>
                    </div>
                    
                    <div id="next-btn-container" class="mt-16 opacity-0 transition-opacity duration-1000">
                        <button id="next-btn" class="px-8 py-3 border-t border-b border-white/10 text-[10px] uppercase tracking-[0.3em] text-white/50 hover:text-white hover:border-white/40 transition-all">
                            Proceed
                        </button>
                    </div>
                </div>
            `;

            // Logic to type words one by one (The Reference Style)
            const textContainer = document.getElementById('mantra-text');
            const words = current.mantra.split(" ");
            textContainer.innerHTML = words.map(w => `<span class="word-reveal">${w}</span>`).join(" ");

            const spans = document.querySelectorAll('.word-reveal');
            let delay = 0;
            
            spans.forEach((span, i) => {
                setTimeout(() => {
                    span.classList.add('visible');
                    // Very subtle tick for word appearance
                    if(i % 2 === 0 && navigator.vibrate) navigator.vibrate(5);
                }, 600 + (i * 500)); // Very slow, hypnotic pace (500ms per word)
                delay = 600 + (i * 500);
            });

            // Show Next Button ONLY after text finishes
            setTimeout(() => {
                const btnContainer = document.getElementById('next-btn-container');
                btnContainer.classList.remove('opacity-0');
                
                const btn = document.getElementById('next-btn');
                btn.onclick = () => {
                    vibrate(20);
                    currentIndex++;
                    if(currentIndex < promises.length) {
                        transitionTo(renderInstruction);
                    } else {
                        transitionTo(renderFinale);
                    }
                };
            }, delay + 1000);
        }

        // --- Render: Finale ---
        function renderFinale() {
            updateBackground('#be123c'); // Deep red for love
            container.innerHTML = `
                <div class="fade-enter flex flex-col items-center justify-center h-full max-w-md w-full p-6">
                    <div class="w-32 h-32 rounded-full border border-white/10 flex items-center justify-center mb-10 animate-pulse">
                        <div class="w-20 h-20 rounded-full bg-rose-500/20 blur-xl"></div>
                    </div>
                    
                    <h1 class="serif text-5xl mb-6 text-white tracking-widest opacity-90">Wholeness.</h1>
                    
                    <div class="glass-panel p-8 rounded-sm relative w-full text-center">
                        <p class="text-slate-200 text-lg leading-relaxed font-light">
                            "The soul within you trusts your biology.<br>It trusts you to carry it."
                        </p>
                        <div class="h-px w-8 bg-white/20 mx-auto my-6"></div>
                        <p class="text-rose-200 text-sm italic opacity-80">
                            You are safe with yourself now.
                        </p>
                    </div>
                    
                    <p class="mt-16 text-[10px] tracking-[0.4em] text-white/20 uppercase">Promise Day 2026</p>
                </div>
            `;
            vibrate([100, 50, 100, 50, 200]); 
        }

        // --- Transition Helper ---
        function transitionTo(renderFn) {
            if(container.firstElementChild) {
                container.firstElementChild.classList.remove('fade-enter');
                container.firstElementChild.classList.add('fade-exit');
            }
            
            setTimeout(() => {
                container.innerHTML = '';
                renderFn();
            }, 800); // Wait for fade out
        }

        // --- Init ---
        window.addEventListener('load', renderIntro);

    </script>
</body>
</html>
